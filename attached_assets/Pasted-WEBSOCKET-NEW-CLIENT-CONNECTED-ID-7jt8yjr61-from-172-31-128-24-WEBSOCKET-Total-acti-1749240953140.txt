WEBSOCKET] ===== NEW CLIENT CONNECTED ===== ID: 7jt8yjr61 from 172.31.128.24
[WEBSOCKET] Total active subscriptions: 1
[WEBSOCKET] Sending initial market data
[PUBLIC WS] Attempting to send market data to client
[PUBLIC WS] WebSocket ready state: 1
[PUBLIC WS] Client subscribed to: 
[PUBLIC WS] Filtered market data entries: 0
[PUBLIC WS] No relevant market data available for subscribed symbols
[WEBSOCKET] Received command from frontend: { type: 'authenticate', userId: 1 }
[USER STREAM] WebSocket API error for user 1: Error: Unexpected server response: 404
    at ClientRequest.<anonymous> (/home/runner/workspace/node_modules/ws/lib/websocket.js:913:7)
    at ClientRequest.emit (node:events:518:28)
    at HTTPParser.parserOnIncomingClient (node:_http_client:702:27)
    at HTTPParser.parserOnHeadersComplete (node:_http_common:118:17)
    at TLSSocket.socketOnData (node:_http_client:544:22)
    at TLSSocket.emit (node:events:518:28)
    at addChunk (node:internal/streams/readable:561:12)
    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
    at Readable.push (node:internal/streams/readable:392:5)
    at TLSWrap.onStreamRead (node:internal/stream_base_commons:191:23)
[USER STREAM] WebSocket API may be restricted on testnet. Notifying client.
[USER STREAM] WebSocket API disconnected for user 1 - Code: 1006, Reason: 
[WEBSOCKET] Received command from frontend: { type: 'account_balance', userId: 1, exchangeId: 2 }
[WEBSOCKET] Processing balance request for user 1, exchange 2
[BALANCE] Starting balance request for user 1, exchange 2
[BALANCE] Fetching exchanges for user 1
[BALANCE] Found 2 exchanges for user 1
[BALANCE] Found target exchange: binance (live), isTestnet: false
[BALANCE] Decrypting API credentials for exchange 2
[BALANCE] API Key length: 64, Secret length: 64
[BALANCE] Error fetching balance for user 1: ReferenceError: require is not defined
    at WebSocketService.requestAccountBalance (/home/runner/workspace/server/websocket-service.ts:781:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
[BALANCE] Sending error response: require is not defined
(node:3735) [DEP0106] DeprecationWarning: crypto.createDecipher is deprecated.
(Use `node --trace-deprecation ...` to show where the warning was created)